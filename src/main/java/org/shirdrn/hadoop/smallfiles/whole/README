jar -cvf combine-smallfiles.jar -C ./ org/shirdrn/hadoop/smallfiles

xiaoxiang@ubuntu3:~$ cd /opt/stone/cloud/hadoop-1.0.3
xiaoxiang@ubuntu3:/opt/stone/cloud/hadoop-1.0.3$ bin/hadoop fs -mkdir /user/xiaoxiang/datasets/smallfiles
xiaoxiang@ubuntu3:/opt/stone/cloud/hadoop-1.0.3$ bin/hadoop fs -copyFromLocal /opt/stone/cloud/dataset/smallfiles/* /user/xiaoxiang/datasets/smallfiles

xiaoxiang@ubuntu3:/opt/stone/cloud/hadoop-1.0.3$ bin/hadoop jar combine-smallfiles.jar org.shirdrn.hadoop.smallfiles.whole.WholeCombinedSmallfiles /user/xiaoxiang/datasets/smallfiles /user/xiaoxiang/output/smallfiles/whole
13/03/23 14:09:24 INFO input.FileInputFormat: Total input paths to process : 117
13/03/23 14:09:24 INFO mapred.JobClient: Running job: job_201303111631_0016
13/03/23 14:09:25 INFO mapred.JobClient:  map 0% reduce 0%
13/03/23 14:09:40 INFO mapred.JobClient:  map 1% reduce 0%
13/03/23 14:09:46 INFO mapred.JobClient:  map 3% reduce 0%
13/03/23 14:09:52 INFO mapred.JobClient:  map 5% reduce 0%
13/03/23 14:09:58 INFO mapred.JobClient:  map 6% reduce 0%
13/03/23 14:10:04 INFO mapred.JobClient:  map 8% reduce 0%
13/03/23 14:10:10 INFO mapred.JobClient:  map 10% reduce 0%
13/03/23 14:10:13 INFO mapred.JobClient:  map 10% reduce 1%
13/03/23 14:10:16 INFO mapred.JobClient:  map 11% reduce 1%
13/03/23 14:10:22 INFO mapred.JobClient:  map 13% reduce 1%
13/03/23 14:10:28 INFO mapred.JobClient:  map 15% reduce 1%
13/03/23 14:10:34 INFO mapred.JobClient:  map 17% reduce 1%
13/03/23 14:10:40 INFO mapred.JobClient:  map 18% reduce 2%
13/03/23 14:10:46 INFO mapred.JobClient:  map 20% reduce 2%
13/03/23 14:10:52 INFO mapred.JobClient:  map 22% reduce 2%
13/03/23 14:10:58 INFO mapred.JobClient:  map 23% reduce 2%
13/03/23 14:11:04 INFO mapred.JobClient:  map 25% reduce 3%
13/03/23 14:11:10 INFO mapred.JobClient:  map 27% reduce 3%
13/03/23 14:11:16 INFO mapred.JobClient:  map 29% reduce 3%
13/03/23 14:11:22 INFO mapred.JobClient:  map 30% reduce 3%
13/03/23 14:11:28 INFO mapred.JobClient:  map 32% reduce 3%
13/03/23 14:11:34 INFO mapred.JobClient:  map 34% reduce 4%
13/03/23 14:11:40 INFO mapred.JobClient:  map 35% reduce 4%
13/03/23 14:11:46 INFO mapred.JobClient:  map 37% reduce 4%
13/03/23 14:11:52 INFO mapred.JobClient:  map 39% reduce 4%
13/03/23 14:11:58 INFO mapred.JobClient:  map 41% reduce 5%
13/03/23 14:12:04 INFO mapred.JobClient:  map 42% reduce 5%
13/03/23 14:12:10 INFO mapred.JobClient:  map 44% reduce 5%
13/03/23 14:12:16 INFO mapred.JobClient:  map 46% reduce 5%
13/03/23 14:12:22 INFO mapred.JobClient:  map 47% reduce 5%
13/03/23 14:12:25 INFO mapred.JobClient:  map 47% reduce 6%
13/03/23 14:12:28 INFO mapred.JobClient:  map 49% reduce 6%
13/03/23 14:12:34 INFO mapred.JobClient:  map 51% reduce 6%
13/03/23 14:12:40 INFO mapred.JobClient:  map 52% reduce 6%
13/03/23 14:12:46 INFO mapred.JobClient:  map 54% reduce 7%
13/03/23 14:12:52 INFO mapred.JobClient:  map 56% reduce 7%
13/03/23 14:12:58 INFO mapred.JobClient:  map 58% reduce 7%
13/03/23 14:13:04 INFO mapred.JobClient:  map 59% reduce 7%
13/03/23 14:13:10 INFO mapred.JobClient:  map 61% reduce 7%
13/03/23 14:13:13 INFO mapred.JobClient:  map 61% reduce 8%
13/03/23 14:13:16 INFO mapred.JobClient:  map 63% reduce 8%
13/03/23 14:13:22 INFO mapred.JobClient:  map 64% reduce 8%
13/03/23 14:13:28 INFO mapred.JobClient:  map 66% reduce 8%
13/03/23 14:13:34 INFO mapred.JobClient:  map 68% reduce 8%
13/03/23 14:13:40 INFO mapred.JobClient:  map 70% reduce 9%
13/03/23 14:13:46 INFO mapred.JobClient:  map 71% reduce 9%
13/03/23 14:13:52 INFO mapred.JobClient:  map 73% reduce 9%
13/03/23 14:13:58 INFO mapred.JobClient:  map 75% reduce 9%
13/03/23 14:14:04 INFO mapred.JobClient:  map 76% reduce 9%
13/03/23 14:14:10 INFO mapred.JobClient:  map 78% reduce 10%
13/03/23 14:14:16 INFO mapred.JobClient:  map 80% reduce 10%
13/03/23 14:14:22 INFO mapred.JobClient:  map 82% reduce 10%
13/03/23 14:14:28 INFO mapred.JobClient:  map 83% reduce 10%
13/03/23 14:14:34 INFO mapred.JobClient:  map 85% reduce 10%
13/03/23 14:14:37 INFO mapred.JobClient:  map 85% reduce 11%
13/03/23 14:14:40 INFO mapred.JobClient:  map 87% reduce 11%
13/03/23 14:14:46 INFO mapred.JobClient:  map 88% reduce 11%
13/03/23 14:14:52 INFO mapred.JobClient:  map 90% reduce 11%
13/03/23 14:14:58 INFO mapred.JobClient:  map 92% reduce 12%
13/03/23 14:15:04 INFO mapred.JobClient:  map 94% reduce 12%
13/03/23 14:15:10 INFO mapred.JobClient:  map 95% reduce 12%
13/03/23 14:15:16 INFO mapred.JobClient:  map 97% reduce 12%
13/03/23 14:15:22 INFO mapred.JobClient:  map 99% reduce 12%
13/03/23 14:15:28 INFO mapred.JobClient:  map 100% reduce 13%
13/03/23 14:15:37 INFO mapred.JobClient:  map 100% reduce 26%
13/03/23 14:15:40 INFO mapred.JobClient:  map 100% reduce 39%
13/03/23 14:15:49 INFO mapred.JobClient:  map 100% reduce 59%
13/03/23 14:15:52 INFO mapred.JobClient:  map 100% reduce 79%
13/03/23 14:15:58 INFO mapred.JobClient:  map 100% reduce 100%
13/03/23 14:16:03 INFO mapred.JobClient: Job complete: job_201303111631_0016
13/03/23 14:16:03 INFO mapred.JobClient: Counters: 29
13/03/23 14:16:03 INFO mapred.JobClient:   Job Counters 
13/03/23 14:16:03 INFO mapred.JobClient:     Launched reduce tasks=5
13/03/23 14:16:03 INFO mapred.JobClient:     SLOTS_MILLIS_MAPS=491322
13/03/23 14:16:03 INFO mapred.JobClient:     Total time spent by all reduces waiting after reserving slots (ms)=0
13/03/23 14:16:03 INFO mapred.JobClient:     Total time spent by all maps waiting after reserving slots (ms)=0
13/03/23 14:16:03 INFO mapred.JobClient:     Launched map tasks=117
13/03/23 14:16:03 INFO mapred.JobClient:     Data-local map tasks=117
13/03/23 14:16:03 INFO mapred.JobClient:     SLOTS_MILLIS_REDUCES=719836
13/03/23 14:16:03 INFO mapred.JobClient:   File Output Format Counters 
13/03/23 14:16:03 INFO mapred.JobClient:     Bytes Written=147035685
13/03/23 14:16:03 INFO mapred.JobClient:   FileSystemCounters
13/03/23 14:16:03 INFO mapred.JobClient:     FILE_BYTES_READ=147032689
13/03/23 14:16:03 INFO mapred.JobClient:     HDFS_BYTES_READ=147045529
13/03/23 14:16:03 INFO mapred.JobClient:     FILE_BYTES_WRITTEN=296787727
13/03/23 14:16:03 INFO mapred.JobClient:     HDFS_BYTES_WRITTEN=147035685
13/03/23 14:16:03 INFO mapred.JobClient:   File Input Format Counters 
13/03/23 14:16:03 INFO mapred.JobClient:     Bytes Read=147029851
13/03/23 14:16:03 INFO mapred.JobClient:   Map-Reduce Framework
13/03/23 14:16:03 INFO mapred.JobClient:     Map output materialized bytes=147036169
13/03/23 14:16:03 INFO mapred.JobClient:     Map input records=117
13/03/23 14:16:03 INFO mapred.JobClient:     Reduce shuffle bytes=145779618
13/03/23 14:16:03 INFO mapred.JobClient:     Spilled Records=234
13/03/23 14:16:03 INFO mapred.JobClient:     Map output bytes=147032074
13/03/23 14:16:03 INFO mapred.JobClient:     CPU time spent (ms)=79550
13/03/23 14:16:03 INFO mapred.JobClient:     Total committed heap usage (bytes)=19630391296
13/03/23 14:16:03 INFO mapred.JobClient:     Combine input records=0
13/03/23 14:16:03 INFO mapred.JobClient:     SPLIT_RAW_BYTES=15678
13/03/23 14:16:03 INFO mapred.JobClient:     Reduce input records=117
13/03/23 14:16:03 INFO mapred.JobClient:     Reduce input groups=117
13/03/23 14:16:03 INFO mapred.JobClient:     Combine output records=0
13/03/23 14:16:03 INFO mapred.JobClient:     Physical memory (bytes) snapshot=20658409472
13/03/23 14:16:03 INFO mapred.JobClient:     Reduce output records=117
13/03/23 14:16:03 INFO mapred.JobClient:     Virtual memory (bytes) snapshot=65064620032
13/03/23 14:16:03 INFO mapred.JobClient:     Map output records=117

xiaoxiang@ubuntu3:/opt/stone/cloud/hadoop-1.0.3$ bin/hadoop fs -ls /user/xiaoxiang/output/smallfiles/whole
Found 7 items
-rw-r--r--   3 xiaoxiang supergroup          0 2013-03-23 14:15 /user/xiaoxiang/output/smallfiles/whole/_SUCCESS
drwxr-xr-x   - xiaoxiang supergroup          0 2013-03-23 14:09 /user/xiaoxiang/output/smallfiles/whole/_logs
-rw-r--r--   3 xiaoxiang supergroup   30161482 2013-03-23 14:15 /user/xiaoxiang/output/smallfiles/whole/part-r-00000
-rw-r--r--   3 xiaoxiang supergroup   30160646 2013-03-23 14:15 /user/xiaoxiang/output/smallfiles/whole/part-r-00001
-rw-r--r--   3 xiaoxiang supergroup   27647901 2013-03-23 14:15 /user/xiaoxiang/output/smallfiles/whole/part-r-00002
-rw-r--r--   3 xiaoxiang supergroup   30161567 2013-03-23 14:15 /user/xiaoxiang/output/smallfiles/whole/part-r-00003
-rw-r--r--   3 xiaoxiang supergroup   28904089 2013-03-23 14:15 /user/xiaoxiang/output/smallfiles/whole/part-r-00004

xiaoxiang@ubuntu3:/opt/stone/cloud/hadoop-1.0.3$ bin/hadoop fs -text /user/xiaoxiang/output/smallfiles/whole/part-r-00000 | cut -d" " -f 1 
data_50000_000	53
data_50000_005	4c
data_50000_014	47
data_50000_019	47
data_50000_023	50
data_50000_028	54
data_50000_032	45
data_50000_037	55
data_50000_041	4e
data_50000_046	4d
data_50000_050	4c
data_50000_055	55
data_50000_064	54
data_50000_069	42
data_50000_073	48
data_50000_078	54
data_50000_082	42
data_50000_087	53
data_50000_091	43
data_50000_096	41
data_50000_203	4d
data_50000_208	49
data_50000_212	48
data_50000_230	46
